<!DOCTYPE html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<!-- <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=css&amp;skin=sunburst"></script> -->
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../css/my-prettyfier-google.css">
</head>
<body onload='PR.prettyPrint()'>

<div class="container">
    <div class="col-md-2 col-xs-12" style="background-color: #d9f2d9;">
        <center>
            <img src="https://avatars0.githubusercontent.com/u/23253178?s=460&v=4" class="img img-rounded" width="100%" id='avtar'>
            <br>
            <br>
            <a href='https://rishikesh67.pythonanywhere.com' id='username'>@hygull</a>
            <h4 id='fullname'>Rishikesh Agrawani</h4>
            <p id="email">rishikesh0014051992@gmail.com</p>
            <hr>

            1. <a href="https://hygull.github.io/codes/python2.7/advanced/pandas/DataFrame-Series-List.html">DataFrame, Series, List, pandas, Slicing...</a>
        </center>
    </div>
    <div class="col-md-10 col-xs-12">
    <center>
        <h1 id='header'>Pandas DataFrame, reading/writing on JSON file</h1>
        <a href="#Python2.7" class="tags">#Python2.7</a>,
        <a href="#pandas" class='tags'>#pandas</a>, <a href="#file-handling" class='tags'>#file-handling</a>, <a href="#DataFrame" class='tags'>#DataFrame</a>
        <hr>
    </center>
    <!-- <pre class='prettyprint'> -->
    <pre class='prettyprint linenums'>
"""
    {
        'aim': 'To use DataFrame in Python, reading & writing operations on JSON file',
        'codedBy': 'Rishikesh Agrawani'
    }
"""

import json
import pandas as pd
import datetime
import time # {Added}

json_backup = 'temp.json'
df_store = pd.DataFrame(columns=["Time", "Average Rate"])

average_rate = 50  # {Added}
count = 1          # {Added}

while True:
    # Doing some data gathering (code not included here) at each loop
    time_data = str(datetime.datetime.now())

    # Store micro seconds of datetime as average 
    # (For test only, use your own logic to calculate it)
    # In case of 2018-06-03 18:44:56.220778 => 220778
    average_rate = int((time_data.split()[1]).split('.')[1]) 

    try:
        df_store = pd.read_json(json_backup)

        df_store = df_store.append({
            "Time": time_data,
            "Average Rate": average_rate
        }, ignore_index=True)
        
        df_store.to_json(json_backup)
        print (df_store)
        print ("***********************************************")       
    except Exception as e:
        df_store = df_store.append({
            "Time": time_data,
            "Average Rate": average_rate
            }, ignore_index=True)

        df_store.to_json(json_backup)
        print(df_store)
        print("***********************************************")

    # time.sleep(30.0 - ((time.time() - starttime) % 30.0))  # {Commented}
    print(count, "temp.json updated")

    # If user presses Y/y then continue otherwise exit from loop
    choice = input("\n" + str(count) + " Do you want to continue the operation (Y/N): ")
    if choice == 'y' or choice == 'Y':
        count = count + 1
        continue
    else:
        break
    </pre> 

    </div>

</div>

</body>